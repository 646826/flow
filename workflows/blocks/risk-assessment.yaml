
name: "risk-assessment"
type: "analyzer"
version: "1.0.0"

risk_categories:
  security:
    weight: 0.4
    indicators:
      - sql_injection_patterns
      - xss_vulnerabilities
      - authentication_bypass
      - data_exposure
      - insecure_dependencies
      - hardcoded_secrets
      
  performance:
    weight: 0.2
    indicators:
      - inefficient_queries
      - memory_leaks
      - blocking_operations
      - resource_intensive_loops
      - unnecessary_computations
      
  maintainability:
    weight: 0.2
    indicators:
      - code_complexity
      - duplicate_code
      - poor_naming
      - missing_documentation
      - tight_coupling
      
  operational:
    weight: 0.2
    indicators:
      - breaking_changes
      - configuration_changes
      - deployment_risks
      - monitoring_gaps
      - rollback_complexity

scoring_matrix:
  critical: 9-10
  high: 7-8
  medium: 4-6
  low: 1-3

assessment_rules:
  - condition: "security_score >= 8"
    action: "block_merge"
    message: "Critical security vulnerabilities detected"
    
  - condition: "overall_score >= 7"
    action: "require_review"
    message: "High-risk changes require additional review"
    
  - condition: "performance_score >= 6 AND file_count > 10"
    action: "performance_review"
    message: "Large changes with performance implications"
    
  - condition: "maintainability_score >= 7"
    action: "architecture_review"
    message: "Changes may impact system architecture"

patterns:
  security_patterns:
    sql_injection:
      regex: "(?i)(select|insert|update|delete).*\\+.*\\$"
      severity: "critical"
      
    hardcoded_secrets:
      regex: "(?i)(password|secret|key|token)\\s*=\\s*['\"][^'\"]{8,}['\"]"
      severity: "high"
      
    xss_vulnerability:
      regex: "innerHTML|outerHTML|document\\.write"
      severity: "high"

  performance_patterns:
    inefficient_loop:
      regex: "for\\s*\\(.*\\)\\s*\\{[^}]*\\n.*\\n.*\\n.*\\n.*\\n.*\\}"
      severity: "medium"
      
    blocking_operation:
      regex: "(?i)(sleep|wait|block|synchronous)"
      severity: "medium"

output:
  format: "structured"
  fields:
    - overall_risk_score
    - category_scores
    - identified_risks
    - recommendations
    - required_actions
    - approval_status
